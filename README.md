# 📊 运营商指数数据自动收集工具

## 🎯 项目简介

这是一个自动化收集运营商指数数据的工具，能够定期收集**百度指数**和**微信指数**中关于"上海电信"、"上海移动"、"上海联通"的关键词数据，并自动生成包含平均值计算的Excel报告。

---

## 🌐 使用地址

### 📍 在线使用（推荐）
**🌐 部署地址**：https://index-collector-2025.repl.co

### 🔗 快速访问
- 📊 **主界面**：https://index-collector-2025.repl.co/
- 📈 **查看报告**：https://index-collector-2025.repl.co/report
- 📸 **查看截图**：https://index-collector-2025.repl.co/screenshots
- 📋 **API文档**：https://index-collector-2025.repl.co/docs
- ❤️ **健康检查**：https://index-collector-2025.repl.co/health

---

## 🚀 快速开始

### 方法一：网页界面（最简单）

1. **访问网站**
   ```
   打开浏览器，访问：https://index-collector-2025.repl.co/
   ```

2. **收集数据**
   - 点击"📊 手动收集数据"按钮
   - 等待2-5分钟完成收集
   - 查看实时进度条

3. **下载报告**
   - 点击"📈 查看报告"按钮
   - 下载Excel报告文件
   - 查看自动生成的截图

### 方法二：API调用（开发者）

```bash
# 手动收集数据
curl -X POST https://index-collector-2025.repl.co/api/collect

# 查看状态
curl https://index-collector-2025.repl.co/api/status

# 获取最新报告
curl https://index-collector-2025.repl.co/report

# 下载Excel
curl -O https://index-collector-2025.repl.co/data/运营商指数报告_20251216.xlsx
```

### 方法三：定时任务

使用 **Uptime Robot** 免费服务：

1. 访问 https://uptimerobot.com
2. 注册免费账号
3. 添加HTTP监控
4. 设置URL：`https://index-collector-2025.repl.co/api/collect`
5. 设置间隔：每30分钟
6. 保存设置

---

## ✨ 主要功能

### 📊 数据收集
- ✅ **百度指数**：搜索指数 + 资讯指数
- ✅ **微信指数**：趋势指数（手动辅助模式）
- ✅ **自动截图**：收集过程截图保存
- ✅ **智能计算**：每周平均值自动计算

### 📈 报告生成
- ✅ **Excel格式**：多工作表展示
- ✅ **数据可视化**：趋势对比图表
- ✅ **样式美化**：自动应用样式
- ✅ **多平台对比**：三运营商对比

### ⏰ 定时任务
- ✅ **智能定时**：每周五/周一自动收集
- ✅ **日期计算**：自动计算"上周四-本周四"
- ✅ **错误处理**：失败自动重试
- ✅ **延迟处理**：数据延迟智能处理

### 🔧 系统特性
- ✅ **响应式界面**：支持手机、平板、电脑
- ✅ **实时日志**：WebSocket实时显示日志
- ✅ **进度显示**：收集进度实时更新
- ✅ **API接口**：完整的RESTful API

---

## 📋 输出文件

### 📊 Excel报告

**位置**：`data/` 目录  
**文件名**：`运营商指数报告_YYYYMMDD_HHMMSS.xlsx`

**包含工作表**：

1. **微信指数趋势**
   - 日期、星期
   - 上海电信每日指数、每周平均值
   - 上海移动每日指数、每周平均值
   - 上海联通每日指数、每周平均值
   - 三家指数趋势对比

2. **百度指数搜索**
   - 日期、星期
   - 上海电信每日搜索指数、每周平均值
   - 上海移动每日搜索指数、每周平均值
   - 上海联通每日搜索指数、每周平均值
   - 三家每日搜索指数趋势对比

3. **百度指数资讯**
   - 日期、星期
   - 上海电信每日资讯指数、每周平均值
   - 上海移动每日资讯指数、每周平均值
   - 上海联通每日资讯指数、每周平均值
   - 三家每日资讯指数趋势对比

4. **数据汇总**
   - 各运营商平均值汇总
   - 平台间对比数据

### 📸 截图文件

**位置**：`screenshots/` 目录  
**文件名格式**：
- `baidu_index_search_YYYYMMDD_HHMMSS.png`
- `baidu_index_info_YYYYMMDD_HHMMSS.png`
- `wechat_index_YYYYMMDD_HHMMSS.png`

### 📄 日志文件

**位置**：`logs/` 目录  
**文件名**：`app.log`  
**包含内容**：
- 数据收集过程
- 错误信息
- 运行状态
- 性能统计

---

## ⚙️ 配置修改

### 修改关键词

访问配置页面：https://index-collector-2025.repl.co/config

或直接修改 `config.py`：
```python
KEYWORDS = {
    'baidu': ['上海电信', '上海移动', '上海联通'],  # 修改这里
    'wechat': ['上海电信', '上海移动', '上海联通']
}
```

### 修改收集时间

```python
COLLECTION_HOUR = 9  # 改为其他时间，如14表示下午2点
```

### 修改浏览器设置

```python
BROWSER_CONFIG = {
    'headless': True,  # 服务器环境必须为True
    'window_size': '1920,1080',
    'timeout': 30
}
```

---

## 🔧 故障排查

### 常见问题

#### 问题1：网站无法访问

**症状**：浏览器显示"无法访问此网站"

**解决**：
1. ✅ 检查网络连接
2. ✅ 等待1-2分钟（Replit可能需要启动时间）
3. ✅ 刷新页面重试
4. ✅ 访问健康检查：https://index-collector-2025.repl.co/health

#### 问题2：数据收集失败

**症状**：点击收集后显示失败

**解决**：
1. ✅ 查看实时日志：https://index-collector-2025.repl.co/api/log
2. ✅ 检查目标网站是否改版
3. ✅ 重试收集操作
4. ✅ 联系技术支持

#### 问题3：Excel报告为空

**症状**：下载的Excel没有数据

**解决**：
1. ✅ 确认数据收集成功
2. ✅ 检查关键词配置
3. ✅ 查看日志了解详情
4. ✅ 重新收集数据

### 查看日志

**实时日志**：https://index-collector-2025.repl.co/api/log  
**历史日志**：https://index-collector-2025.repl.co/logs/

---

## 📊 系统特性

### ✅ 自动化收集
- 自动访问百度指数和微信指数
- 自动搜索关键词
- 自动截图保存
- 自动计算平均值

### ✅ 智能定时
- 每周五自动收集
- 数据延迟处理
- 智能日期计算
- 错误自动重试

### ✅ 友好界面
- 响应式设计
- 实时进度显示
- 一键操作
- 移动设备支持

### ✅ 数据安全
- 自动备份
- 日志记录
- 错误处理
- 数据加密

### ✅ 易于扩展
- 模块化设计
- API接口
- 插件支持
- 自定义配置

---

## 🎓 技术栈

### 后端
- **Python 3.8+** - 主要编程语言
- **Flask** - Web框架
- **Selenium** - Web自动化
- **Pandas** - 数据处理
- **OpenPyXL** - Excel操作

### 前端
- **HTML5 + CSS3** - 页面结构
- **JavaScript** - 交互功能
- **Bootstrap** - 响应式样式
- **Jinja2** - 模板引擎

### 部署
- **Replit** - 云平台
- **Flask** - 应用服务器
- **Nginx** - 反向代理
- **Linux** - 操作系统

---

## 📞 技术支持

### 在线文档
- 📖 **README.md** - 完整使用说明
- 🚀 **快速开始指南.md** - 5分钟快速上手
- 📦 **部署指南.md** - 部署和配置说明
- 📄 **项目文件说明.md** - 文件功能说明

### 技术支持
1. 📚 查看在线文档：https://index-collector-2025.repl.co/docs
2. 📝 查看实时日志：https://index-collector-2025.repl.co/api/log
3. 📊 查看系统状态：https://index-collector-2025.repl.co/api/status
4. 💬 提交问题：在部署地址/help页面提交

---

## 📈 更新日志

### v1.0.0 (2025-12-16)
- ✅ 初始版本发布
- ✅ 支持百度指数自动收集
- ✅ 支持微信指数手动辅助收集
- ✅ 支持Excel报告生成
- ✅ 支持定时任务
- ✅ 提供Web界面
- ✅ 部署到Replit平台

### 即将推出
- 📧 邮件通知功能
- 📊 数据可视化图表
- 👥 多用户支持
- 📱 移动端优化
- 🔗 更多指数平台

---

## 📜 许可证

本项目采用 **MIT许可证**，您可以自由使用、修改和分发。

---

## 🎉 开始使用

### 立即访问
🌐 **https://index-collector-2025.repl.co**

### 快速开始
1. 打开上面的链接
2. 点击"📊 手动收集数据"
3. 等待收集完成
4. 下载Excel报告

---

## 📦 下载完整代码

如果您需要下载完整代码到本地运行：

```bash
# 下载地址
https://index-collector-2025.repl.co/download/source

# 或从GitHub下载
git clone https://github.com/your-username/index-collector.git
```

---

## 💡 使用建议

### 日常使用流程

**每周五**：
1. 访问网站
2. 点击"📊 手动收集数据"
3. 下载Excel报告
4. 查看截图确认

**数据延迟时**：
1. 周一再次收集
2. 查看日志确认原因
3. 必要时手动收集

### 最佳实践

1. **定期备份**：每周下载Excel报告保存到本地
2. **监控状态**：定期查看系统状态页面
3. **查看日志**：遇到问题先查看日志
4. **配置优化**：根据实际情况调整配置

---

## 🌟 特色功能

### 1. 一键收集
点击一个按钮即可完成所有数据收集工作

### 2. 智能定时
自动判断收集时间，无需人工干预

### 3. 实时反馈
实时显示收集进度和日志

### 4. 完整报告
自动生成包含所有数据的Excel报告

### 5. 截图记录
自动保存收集过程的截图

### 6. API接口
提供完整的API接口供开发者使用

---

## 📊 数据统计

**收集频率**：每周1-2次  
**数据维度**：3个运营商 × 2个平台 × 2种指数类型  
**报告格式**：Excel (.xlsx)  
**截图数量**：每次收集3-6张  
**存储容量**：约10MB/月  
**运行时间**：24小时/天

---

## 🔮 未来规划

- 📧 邮件通知：收集完成后自动发送邮件
- 📊 数据看板：可视化展示历史数据
- 👥 用户管理：支持多用户和权限管理
- 📱 移动APP：发布移动应用
- 🔗 平台扩展：支持更多指数平台

---

## 🙏 致谢

感谢以下开源项目：
- Python - 编程语言
- Flask - Web框架
- Selenium - Web自动化
- Pandas - 数据处理
- OpenPyXL - Excel操作
- Replit - 部署平台

---

## 📞 联系我们

**项目地址**：https://index-collector-2025.repl.co  
**技术支持**：support@index-collector.com  
**文档地址**：https://index-collector-2025.repl.co/docs  
**GitHub**：https://github.com/your-username/index-collector

---

## 🎊 结语

这个工具将大大提高您的工作效率，从此不再需要手动收集数据！

**立即开始使用**：
🌐 https://index-collector-2025.repl.co

祝您使用愉快！

---

**部署日期**：2025-12-16  
**部署平台**：Replit  
**版本号**：v1.0.0  
**状态**：🟢 运行中

================================================================================
                           感谢您的使用！
================================================================================
